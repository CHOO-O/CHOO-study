# DNS 서버

> 네트워크 관리사 대비 스터디 12일차 정리 내용으로, [이기적 네트워크관리사 1ㆍ2급 필기+실기] 교재 커리큘럼을 따라갑니다.

## 윈도우 DNS 서버

### 윈도우 DNS 서버란?

🔹 윈도우 DNS 서버는 DDNS(Dynamic Domain Name Service)라는 DNS 서버를 관리할 수 있다.<br>
🔹 DHCP 서버와 연동해서 관리할 수 있는 기능을 제공한다.

> DHCP 서버는 사용자 PC에 IP를 동적으로 할당해준다.

### 윈도우 DNS 서버의 기능

🔹 사용자 PC가 DNS Request로 도메인 주소를 전송하면 DNS 서버가 해당 도메인에 대한 IP 주소를 찾아 DNS Response로 보내준다.<br>
🔹 반대로 IP 주소를 DNS 서버에 전송하면 해당하는 도메인 주소를 전송한다.<br>
🔹 TCP/UDP 프로토콜을 사용하며, 53번 포트를 사용한다.<br>

> **DNS Cache란?**<br>사용자 PC가 요청할 때 마다 DNS 서버가 도메인을 해석하면 서버에 많은 부하가 발생할 것이다.<br>따라서 사용자 PC와 DNS 서버에 DNS Cache를 두어 자주 참조하는 도메인명과 IP주소를 메모리에 유지하도록 한다.

### 주 영역 DNS와 보조 영역 DNS

🔹 DNS 서버에 장애가 발생해도 도메인을 해석할 수 있도록, 고가용성을 챙기기 위해 주 영역/보조 영역으로 이중화시킨다.<br>
|**구분**|**설명**|
|---|---|
|**주(Primary) 영역 DNS**| 🔹 DNS 서버로서 도메인을 해석하고 DNS 서버에 영역(Zone)을 등록한다.<br>🔹 등록된 영역 정보는 Zone Transfer를 통해서 보조 영역 DNS에게 전송한다.|
|**보조(Second) 영역 DNS**|🔹 주 영역 DNS 서버 장애 시 DNS 서버의 역할을 수행한다.|

> **영역(Zone)이란?**<br>DNS에서 도메인 주소를 관리하는 기본 관리 단위이다.

## DNS 영역

### 정방향 영역(Public Domain Zone)

🔹 도메인 주소 ➡ IP 주소<br>
🔹 DNS Query에 대해 어떤 형태의 IP 주소(IPv4, IPv6)로 응답할지를 결정한다.<br>

1. 윈도우 `DNS 관리자` - `정방향 조회 영역`을 선택하고 우클릭하면 `새 영역` 메뉴가 나온다.
2. `새 영역 마법사`가 실행되면 `영역 형식`에서 `주 영역`을 선택한다.
3. `영역 이름`엔 도메인 주소를 입력한다.
4. `영역 파일`은 도메인 주소에 자동적으로 DNS가 붙여진 것이다. 변경도 가능하다.
5. `동적 업데이트 허용 여부`도 설정한다.
6. 정방향 영역 생성이 완료되었다.

### 역방향 영역(Inverse Domain Zone)

🔹 IP 주소 ➡ 도메인 주소<br>

1. 윈도우 `DNS 관리자` - `역방향 조회 영역`을 선택하고 우클릭하면 `새 영역` 메뉴가 나온다.
2. `새 영역 마법사`가 실행되면 `영역 형식`에서 `주 영역`을 선택한다.
3. 역방향은 IP주소로 응답하기 때문에 `IPv4`로 응답 할 지, `IPv6`로 응답할 지를 선택한다.
4. C Class의 네트워크는 IP 주소 3영역만 입력한다.
5. `영역 파일`은 도메인 주소에 자동적으로 DNS가 붙여진 것이다. 변경도 가능하다.
6. `동적 업데이트 허용 여부`도 설정한다.
7. 역방향 영역 생성이 완료되었다.

## DNS 레코드(Record)

### 호스트

🔹 DNS 서버가 사용자에게 어떤 형식의 정보로 응답할지를 결정하기 위해 호스트를 등록하며, 이 때 사용되는 것이 레코드(Record)이다.<br>
🔹 호스트는 도메인 이름에서 특정 기기를 나타내는 부분이라고 할 수 있으며, DNS 서버가 이 호스트를 IP주소와 연결한다.<br>
🔹 예시로, `www.aaa.com`에서 호스트는 `www`이다. A 레코드를 등록하면 `www.aaa.com`을 입력하면 IPv4 주소로 응답하게 된다.

1. `DNS 관리자`에서 등록한 정방향 조회 영역을 우클릭하면 `새 호스트` 메뉴가 나온다.
2. 새 호스트를 선택하면 해당 도메인 주소에 대한 `IP 주소`를 입력한다.

### 메일(Mail Exchanger) 레코드

🔹 DNS 서버가 전자우편을 어떤 서버로 전달할지 지정하는 레코드이다.<br>
🔹 예시로, `aaa@bbb.com`이라는 전자우편에서 `bbb.com`의 도메인에 메일을 어떤 형식으로 전송할 것인지를 설정한다.

### PTR(Pointer) 레코드

🔹 역방향 조회 영역에서 사용자 PC가 IP 주소를 전송하면 도메인 주소로 변경하기 위해 등록하는 레코드이다.<br>
🔹 역방향 조회 영역에서만 사용된다.<br>
🔹 IP 주소에 대해서 역방향 조회 영역을 추가한다.<br>

### SOA(Start Of Authority) 레코드

🔹 도메인 영역의 등록 정보를 가지고 있는 기본 레코드이다.<br>
🔹 영역(Zone) 생성 시 자동으로 생성된다.<br>
🔹 주 영역과 보조 영역 간의 동기화 정보, DNS 정보 보유에 대한 시간 정보 등을 가지고 있다<br>

🔹 **일련번호** : 영역 변경 시 증가하는 번호로 보조 영역 DNS 서버에 전송한다.<br>
🔹 **주 서버** : 주 영역 DNS 서버의 도메인 주소이다.<br>
🔹 **책임자** : 책임자의 전자우편 주소이다.<br>
🔹 **새로 고침 간격** : 주 영역과 보조 영역 간의 통신 간격이다.<br>
🔹 **다시 시도 간격** : 주 영역과 보조 영역 간 통신 장애 발생 시 재시도하는 간격이다.<br>
🔹 **다음 날짜 이후에 만료** : 설정기간을 통과하여 통신 두절 시 동작 정지 정보이다.<br>
🔹 **최소(기본값) TTL** : 레코드의 캐시 시간이다.<br>
🔹 **이 레코드의 TTL** : SOA 레코드의 TTL이다.<br>

### CNAME 레코드

🔹 별명(Alias)를 입력한다.<br>
🔹 같은 IP 주소를 가진 여러 호스트가 있을 때 용이하다.<br>
🔹 A 레코드에 비해 속도가 빠르며 호스트 이름을 등록해 관리한다.
