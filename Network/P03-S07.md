# 리눅스(Linux)

> 네트워크 관리사 대비 스터디 14, 15일차 정리 내용으로, [이기적 네트워크관리사 1ㆍ2급 필기+실기] 교재 커리큘럼을 따라갑니다.

## 리눅스 개요

### 리눅스(Linux)란?

🔹 1989년 리누스 토르발스(Linus Torvalds)가 개발한 유닉스(Unix)기반 오픈소스 운영체제이다.<br>
🔹 대형 서버를 위해 개발된 유닉스와 달리 개인용 컴퓨터나 워크스테이션을 위해 개발되었다.<br>
🔹 오픈소스이므로 사용자가 수정하여 사용할 수도 있다.<br>

### 리눅스의 특징

| **특징**                            | **설명**                                                                                                                                                 |
| ----------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **다중 사용자(Multi User)**         | 🔹 여러 명의 사용자가 네트워크를 통해 접속해 컴퓨터 시스템을 사용할 수 있다.<br>🔹 따라서 사용자 별 권한 관리와 자원 관리를 지원한다.                    |
| **다중 작업(Multi-Tasking)**        | 🔹 스케줄링 기능을 포함해 여러 프로세스를 동시에 실행시킬 수 있다.<br>🔹 스케줄링은 기본적으로 시간 사용량만큼 자원을 할당하는 시분할 시스템을 지원한다. |
| **다중 처리기(Multi-Processor)**    | 🔹 컴퓨터 시스템에 한 개 이상의 CPU가 탑재되어 있는 경우 다중 처리기로 지원해 작업을 병렬적으로 처리한다.                                                |
| **다중 플랫폼(Multi-Platform)**     | 🔹 인텔, Sun Sparc, Power PC 등 여러 종류의 CPU를 지원한다.                                                                                              |
| **계층형 파일 시스템(File System)** | 🔹 루트(Root)를 기반으로 하위 디렉터리를 이루는 계층형 파일 시스템으로 이루어져있다.                                                                     |
| ***POSIX*와 호환**                  | 🔹 리눅스는 POSIX 표준을 따른다.                                                                                                                         |
| **우수한 네트워킹(Networking)**     | 🔹 TCP/IP, IPX/SPC, Appletalk, Bluetooth 등 다양한 프로토콜을 지원한다.<br>🔹 IP 주소, 게이트웨이, 서브넷 등을 설정하면 바로 네트워크를 사용할 수 있다.  |
| **가상 콘솔(Virtual Console)**      | 🔹 기본적으로 6개의 가상 콘솔이 있으며 각 창마다 서로 다른 작업을 수행할 수 있어 물리적 모니터의 한계를 극복한다.                                        |
| **가상 기억장치(Virtual Memory)**   | 🔹 보조 기억장치를 마치 주 기억장치처럼 사용할 수 있게 해 주 기억장치의 공간을 증대하는 방법이다.                                                        |

> **POSIX란?**<br>IEEE가 지정한 유닉스 시스템의 표준 인터페이스 규격이다.<br>다양한 유닉스 계열 운영체제의 공통적인 API를 제시해 이식성을 높혔다.

### 리눅스의 구조

🔹 리눅스는 크게 커널(Kernel), 셸(Shell), 파일 시스템(File System)으로 구성된다.

| **구성 요소**                | **설명**                                                                                                      | **기능**                                                                                                                                                                                                 |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **커널(Kernel)**             | 주 기억 장치에 상주하는 운영체제의 핵심 기능으로 프로세서, 프로세스, 메모리 입출력 장치 등의 기능을 수행한다. | 🔹 프로세서(Processor) 사용을 관리한다.<br>🔹 주 기억장치(Main Memory) 사용을 관리한다.<br>🔹 실행 중인 프로세스를 관리한다.(Process Management)<br>🔹 주변 장치와 입출력을 관리한다.(Device Management) |
| **셸(Shell)**                | 사용자가 입력한 명령어를 해석/번역하고 실행하는 **인터프리터(Interpreter)** 기능을 수행한다.                  | 🔹 사용자의 명령어를 실행한다.<br>🔹 리눅스 표준 셸은 **bash**이며, 이외에도 C Shell, Korn Shell 등이 있다.                                                                                              |
| **파일 시스템(File System)** | 계층적인 트리 구조를 가진다.                                                                                  | 🔹 파일과 디렉터리 등에 권한을 설정하고 해제한다.<br>🔹 파일의 연결 정보인 링크를 관리한다.<br>🔹 파일의 소유자, 그룹, 파일 생성 일자, 변경 일자 등을 관리한다.                                          |

### 셸(Shell)

![Shell](https://github.com/CHOO-O/CHOO-study/blob/main/Network/assets/P03-S07-Shell.png?raw=true)

🔹 입력된 명령 줄을 해석하고 실행할 프로그램을 결정한다.<br>
🔹 와일드카드(`*`, `?`), 히스토리(`!!`, `!n`), 특수 문자(`$`, `&` 등)를 해석한다.<br>
🔹 프로그램을 실행하고 시그널(`Ctrl+c`, `Ctrl+z` 등)을 처리한다.<br>
🔹 파이프, 리디렉션, 백그라운드 프로세스를 지원한다.<br>
🔹 셀 환경 정보를 확인하려면 `env` 명령어를, 환경 변수를 설정하고싶다면 `set`명령어를 실행하면 된다.

| **셸 종류**                        | **특징**                                                                                                    |
| ---------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| **C Shell(Berkeley Unix C Shell)** | 🔹 `cshrc`파일에 필요한 환경 변수를 저장해 로그인 시 자동 수행 기능이 있어 사용자의 편리성을 높혔다.        |
| **Bourne Shell**                   | 🔹 `.profile`파일에 환경 변수를 저장한다.                                                                   |
| **Korn Shell**                     | 🔹 `.kshrc` 또는 `.profile`파일에 환경 변수를 저장한다.<br>🔹 C 셸 기능을 모두 제공한다.                    |
| **Bash Shell**                     | 🔹 GNU 프로젝트에 의해 개발된 C shell과 Korn Shell의 특징을 결합한 셸이다.<br>🔹 명령 편집 기능을 제공한다. |
| **TC Shell(tcsh)**                 | 🔹 C Shell의 기능을 강화한 것으로 명령 편집 기능을 제공한다.                                                |

### 파일 시스템(File System)

🔹 ext(extend)2, ext3, ext4가 있으며 현재 대부분의 리눅스는 ext4를 지원한다.<br>
|**종류**|**특징**|
|---|---|
|**ext2**|🔹 최대 2 Gigabyte의 단일 파일 크기를 지원한다.<br>🔹 최대 256 Byte의 파일명을 지원한다.<br>🔹 최대 4 Terabyte의 파일 시스템 크기를 지원한다.<br>🔹 디렉터리당 약 25,500개의 파일을 저장할 수 있다.|
|**ext3**|🔹 최대 4 Gigabyte의 단일 파일 크기를 지원한다.<br>🔹 최대 256 Byte의 파일명을 지원한다.<br>🔹 최대 16 Terabyte의 파일 시스템 크기를 지원한다.<br>🔹 디렉터리당 약 65,565개의 파일을 저장할 수 있다.<br>🔹 *저널링 파일 시스템*을 지원한다.|
|**ext4**|🔹 **대용량 파일 지원** : 1 Exabyte의 블록 지원, 16 Terabyte의 단일 파일 크기를 지원한다.<br>🔹 **호환성** : ext2, ext3과 호환성을 가지며 마운트 가능하다.<br>🔹 **fsck** : 파일 무결성 오류 시 실행되는 fcsk 성능이 향상되었다.<br>🔹 **Extends 지원** : 큰 사이즈의 파일을 삭제할 때 시간을 단축했다.<br>🔹 **하위 디렉터리** : 하위 디렉터리 수 제한이 32,000개에서 2배 확대되었다.<br>🔹 **조작모음** : ext3 저널링 파일 시스템에서 발생되는 단편화를 조작모음으로 개선했다.|

> **저널링 파일 시스템이란?**<br>파일 시스템 오류 수정을 위한 파일 시스템이다.

### 파일 시스템 디렉터리 구조

🔹 디렉터리(Directory)란 운영체제의 파일을 관리하기 위한 구조이다.<br>
🔹 리눅스 디렉터리는 계층형 파일 시스템으로 이루어져 있다.<br>
🔹 다중 사용자를 지원하므로 각 사용자 별로 디렉터리를 생성한다.<br>

| **디렉터리명** | **설명**                                                                                                                               |
| -------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| **/**          | 루트 디렉터리                                                                                                                          |
| **/bin**       | 기본적인 실행 명령                                                                                                                     |
| **/boot**      | 리눅스 부트 프로그램 LILO 등 부팅 관련 파일                                                                                            |
| **_/dev_**     | 주변장치 파일 모음 (CDROM, USB, Printer 등)                                                                                            |
| **/etc**       | 시스템 설정 파일, 환경설정 관련 파일<br>사용자 패스워드 파일(`passwd`, `shadow`), 프로토콜 및 서비스 정보 파일(`protocol`, `services`) |
| **/home**      | 사용자 홈 디렉터리<br>각 사용자 별로 디렉터리를 생성하면 `/home` 하위에 생성됨                                                         |
| **/lib**       | C 라이브러리                                                                                                                           |
| **/mnt**       | 임시 마운트용 디렉터리                                                                                                                 |
| **/proc**      | 시스템 정보를 가진 가상 디렉터리<br>실행 중인 리눅스 정보를 가지고 있음 (CPU 및 메모리 사용량, 파티션 정보, 입출력 DMA 등)             |
| **/root**      | 루트 사용자의 홈 디렉터리                                                                                                              |
| **/sbin**      | 시스템 관리용 실행 파일                                                                                                                |
| **/tmp**       | 임시파일 디렉터리                                                                                                                      |
| **/usr**       | 애플리케이션이 설치되는 디렉터리                                                                                                       |
| **/var**       | 시스템에서 운영되는 임시파일 및 로그 파일                                                                                              |

> **/dev 하위 장치 파일 시스템**<br>
> |**디렉터리명**|**설명**|
> |---|---|
> |**/dev/fd**|플로피 디스크|
> |**/dev/sda**|SCSI 및 SATA 하드 디스크|
> |**/dev/cdrom**|CD ROM 드라이버|
> |**/dev/mouse**|마우스|
> |**/dev/had**|마스터 IDE 하드 디스크(첫 번째 하드 디스크)|
> |**/dev/hdb**|슬레이브 IDE 하드 디스크(두 번째 하드 디스크)|
> |**/dev/hd**|하드 디스크|

### 리눅스 계정 관리

🔹 `useradd` 혹은 `adduser` 명령어로 사용자를 생성할 수 있다.<br>
🔹 사용자가 계정으로 로그인 하기 위해 패스워드를 입력하면 `/etc/passwd`와 `/etc/shadow`파일을 참조해 정당한 사용자(Right User)인지 확인 후 로그인을 수행한다.

#### /etc/passwd 파일 구조

🔹 이 파일은 모든 사용자가 읽을 수 있으며, 루트 사용자만 쓸 수 있다.<br>
![passwd](https://github.com/CHOO-O/CHOO-study/blob/main/Network/assets/P03-S07-passwd.png?raw=true)

1️⃣ **Login Name** : 사용자 ID<br>
2️⃣ **Password** : 사용자 암호 필드이나 실제 암호는 `shadow`파일에 저장되며, 일반적으로 `passwd` 파일엔 `x` 혹은 `*`로 표기된다.<br>
3️⃣ **User ID** : 사용자 UID<br>
4️⃣ **User Group ID** : 사용자 그룹 ID(GID)<br>
5️⃣ **Comments** : 사용자 설명 필드. 일반적으로 이름 정도를 작성한다.<br>
6️⃣ **Home Directory** : 사용자의 홈 디렉터리 경로<br>
7️⃣ **Shell** : 사용자의 기본 셸 종류<br>

> | UID,GID 값  | 설명                                                                      |
> | ----------- | ------------------------------------------------------------------------- |
> | `0`         | 루트(root) 사용자/그룹. 최상위 권한을 가짐.                               |
> | `1~99`      | 시스템에서 예약된 UID/GID (일반적으로 특정 데몬 및 서비스용)              |
> | `100~999`   | 시스템 사용자(서비스 계정)/그룹. `systemd`, `mysql`, `nginx` 등이 포함됨. |
> | `1000` 이상 | 일반 사용자의 UID/GID (일반적으로 첫 번째 일반 사용자의 UID는 `1000`)     |

#### /etc/shadow 파일 구조

🔹 이 파일은 루트 사용자만 읽고 쓸 수 있다.<br>
![shadow](https://github.com/CHOO-O/CHOO-study/blob/main/Network/assets/P03-S07-shadow.png?raw=true)

1️⃣ **Login Name** : 사용자 ID<br>
2️⃣ **Encrypted** : **암호화**된 사용자 암호<br>
3️⃣ **Last Changed** : 마지막 패스워드 변경 날짜. 1970년 1월 1일 기준 일 수로 기록된다.<br>
4️⃣ **Minimum** : 패스워드를 변경할 수 없는 최소 일 수.(`0`이면 언제든지 변경 가능)<br>
5️⃣ **Maximum** : 패스워드를 유지할 수 있는 최대 일 수.(`99999`이면 만료되지 않음)<br>
6️⃣ **Warn** : 패스워드 만료 전 사용자에게 경고하는 일 수.(`7`이면 만료 7일 전 경고 메시지 출력)<br>
7️⃣ **Inactive** : 패스워드 만료 후 계정 비활성화까지의 유예 기간.(비어있으면 비활성화되지 않음)<br>
8️⃣ **Expire** : 계정이 만료되는 날짜.(비어있으면 만료되지 않음)<br>

> **Reserved 필드** <br> 현재 사용되지 않는 필드로 `:`만 존재하고 비어있다.

### 리눅스 권한 관리

![permissions](https://github.com/CHOO-O/CHOO-study/blob/main/Network/assets/P03-S07-permissions.png?raw=true)

#### umask

🔹 umask값은 디렉터리/파일이 생성될 때 적용될 기본 권한을 의미한다.<br>
🔹 디렉터리의 기본 권한은 777, 파일의 기본 권한은 666이다.<br>
🔹 4자리의 umask값은 특수 권한(SUID, SGID, Sticky Bit) 제한을 포함한 값이다.<br>
🔹 최종 권한 = 기본 권한 - umask 값이 된다. (ex. 파일의 umask = 022면 최종 권한 = 666 - 022 = 644 = rw-r--r--)

#### chmod

🔹 `chmod [옵션] 파일명` 명령어를 통해 사용자에게 권한을 부여할 수 있다.<br>
🔹 `-u`는 사용자, `-g`는 그룹, `-o`는 다른 사용자이다.<br>

| **명령 기호** | **설명** |
| ------------- | -------- |
| **u**         | user     |
| **g**         | group    |
| **o**         | other    |
| **a**         | all      |
| **+**         | 추가     |
| **-**         | 삭제     |
| **r**         | 읽기     |
| **w**         | 쓰기     |
| **x**         | 실행     |

#### chown

🔹 `chown [옵션][소유자명:그룹명 또는 UID:GUID][파일명/디렉터리명]` 명령어를 통해 파일/디렉터리에 대한 **소유권**을 변경할 수 있다.<br>

| **명령어 옵션** | **설명**                                   |
| --------------- | ------------------------------------------ |
| **-R**          | 하위 디렉터리의 모든 권한을 변경           |
| **-c**          | 소유자나 그룹이 변경된 경우 변경 내역 출력 |

| **명령어 대상** | **설명**         |
| --------------- | ---------------- |
| **u**           | user 권한        |
| **g**           | group 권한       |
| **o**           | other 권한       |
| **a**           | 모든 사용자 권한 |

| **명령어 인자 값** | **설명**              |
| ------------------ | --------------------- |
| **+**              | 해당 권한을 더함      |
| **-**              | 해당 권한을 제거함    |
| **=**              | 해당 권한 그대로 변경 |

#### chgrp

🔹 `chgrp [옵션][파일명/디렉터리명]` 명령어를 통해 파일/디렉터리에 대한 그룹을 변경할 수 있다. 단, 소유자는 변경할 수 없다.<br>

| **옵션** | **설명**                                             |
| -------- | ---------------------------------------------------- |
| **-c**   | 그룹이 변경된 경우 변경 내역 출력                    |
| **-h**   | _심볼릭 링크_ 자체의 그룹을 변경                     |
| **-f**   | 오류 메시지를 출력하지 않고 실행                     |
| **-v**   | 그룹 변경 여부와 관계없이 모든 파일의 변경 내역 출력 |
| **-R**   | 하위 모든 파일도 지정한 그룹으로 변경                |

> **심볼링 링크란?**<br>원본 파일을 가리키는 바로가기 역할을 하는 파일이다.<br>기본 `chgrp` 또는 `chown`명령어를 실행하면 심볼릭 링크가 아니라 원본 파일의 그룹이 변경된다.

#### 특수 권한

| 특수 권한      | 기호 | 8진수  | 설명                                                   |
| -------------- | ---- | ------ | ------------------------------------------------------ |
| **SetUID**     | `s`  | `4XXX` | 실행 시 파일 소유자의 권한으로 실행한다.               |
| **SetGID**     | `s`  | `2XXX` | 파일 생성자의 그룹 소유권을 얻는다.                    |
| **Sticky Bit** | `t`  | `1XXX` | 디렉터리에서 파일 삭제를 소유자만 가능하도록 제한한다. |
